# fuente original: https://www.lesinskis.com/travis_ci_django.html

# De la documentacion: https://docs.travis-ci.com/user/notifications/#configuring-email-notifications
# Para cambiar opciones de email:
# notifications:
#   email:
#     recipients:
#       - one@example.com
#       - other@example.com
#     on_success: never # default: change
#     on_failure: always # default: always
#
# # O hacer que nunca envie mails:
# notifications:
#   email: false

language: python

python:
  #- "3.4"
  - "3.7"

# usamos postgres
services: postgresql

env:
  global:
    - DJANGO_SETTINGS_MODULE="servidor.settings"
    - PYTHONPATH="/home/travis/build/UNIZAR-30226-2020-01/backend_django/servidor"
    - PIP_USE_MIRRORS=true
    #- BUILD_ON_TRAVIS=true # ya no es necesaria, por defecto tenemos TRAVIS=true
  matrix:
    - DB=postgres

#commands to install dependencies
install:
#- pip install -q Django==$DJANGO # ahora en requirements
  - pip install -q -r servidor/requirements.txt

before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
  - python servidor/manage.py migrate --noinput

#command to run the test suite
script:
  - python servidor/manage.py test


# TODO: Integrar con la m√°quina de Azure
# deploy:
#   -
